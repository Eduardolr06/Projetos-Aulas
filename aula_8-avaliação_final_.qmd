---
title: "Eduardo Luiz Rodrigues"
format: html
editor: visual
---

```{r}
#| label: load-packages # nomes √∫nicos
#| include: false # n√£o inclui o resultado no doc

library(tidyverse) # pacote ggplot2 (gr√°ficos)
library(WDI) # pacote dos dados
library(countrycode) #pacote com os c√≥digos dos paises

options(scipen = 999)

# BASE DE DADOS #
# DADOS EM PAINEL
PASSENGERS_CARRIED <- WDI(country = 'all', indicator = 'IS.AIR.PSGR')

# CORTE TRANSVERSAL
FORCAS_ARMADAS <- WDI(country = 'all',
                      indicator = 'MS.MIL.TOTL.P1',
                      start = 2020, end = 2020)

# SERIE TEMPORAL
producao_cereal <- WDI(country = 'CHN',
                       indicator = 'AG.PRD.CREL.MT')

```

## VARI√ÅVEIS

Apresenta 3 vari√°veis diferentes entre elas temos:\

### Passageiros Transportados

A vari√°vel **Passageiros Transportados** indica o n√∫mero total de passageiros transportados por um determinado meio de transporte durante um per√≠odo de tempo espec√≠fico. Esse indicador √© importante para medir a demanda e a capacidade de transporte de uma empresa ou setor, refletindo diretamente a popularidade e a efici√™ncia do servi√ßo oferecido. Em contextos gerais, essa vari√°vel pode ser usada para analisar o crescimento do setor de transporte e a mobilidade de uma popula√ß√£o, sendo uma m√©trica fundamental no planejamento urbano e no desenvolvimento de infraestruturas de transporte.

### For√ßas Armadas

A vari√°vel **For√ßas Armadas** representa o n√∫mero total de membros ou o or√ßamento destinado √†s for√ßas armadas de um pa√≠s, respons√°veis pela defesa nacional e pela seguran√ßa do territ√≥rio. Essa vari√°vel reflete a capacidade de um pa√≠s de proteger suas fronteiras e garantir sua soberania. Em contextos gerais, as for√ßas armadas s√£o usadas para avaliar a pol√≠tica de defesa de um pa√≠s, sua estabilidade pol√≠tica e seu poder militar, sendo crucial para analisar o impacto de gastos p√∫blicos, a aloca√ß√£o de recursos e a postura militar em rela√ß√£o a outros pa√≠ses.

### Produ√ß√£o de Cereal

A vari√°vel **Produ√ß√£o de Cereal** mede a quantidade total de cereais (como trigo, milho, arroz, entre outros) produzidos em uma determinada regi√£o ou pa√≠s durante um per√≠odo espec√≠fico. Esse indicador est√° relacionado √† seguran√ßa alimentar, √† sustentabilidade agr√≠cola e ao desempenho econ√¥mico do setor agr√≠cola. Em contextos gerais, a produ√ß√£o de cereal √© utilizada para avaliar a efici√™ncia da agricultura, as condi√ß√µes clim√°ticas e as pol√≠ticas agr√≠colas de um pa√≠s, al√©m de ser um fator essencial nas negocia√ß√µes comerciais e no estudo de mercados internacionais de alimentos.

## GR√ÅFICO DADOS EM PAINEL

Um gr√°fico de dados em painel √© empregado para exibir informa√ß√µes que envolvem duas ou mais dimens√µes ao longo do tempo. Esse tipo de gr√°fico permite observar a evolu√ß√£o de diferentes pa√≠ses, regi√µes ou estados em rela√ß√£o a uma vari√°vel espec√≠fica ao longo de um per√≠odo.

Al√©m disso, o gr√°fico de dados em painel facilita a compara√ß√£o entre v√°rias localidades, permitindo identificar padr√µes, como a continuidade de um crescimento ou a estagna√ß√£o em determinadas √°reas.

Neste gr√°ficos analisamos dados de passageiros transportados de v√°rios pa√≠ses, por√©m destancando na cor verde os dados relacionados ao Brasil e em azul ao Estados Unidos.

```{r}
#| label: dadosempainel 
#| warning: false
#| echo: false

# Baixar dados
PASSENGERS_CARRIED <- WDI(country = 'all', indicator = 'IS.AIR.PSGR')

# Adiciona uma coluna com r√≥tulo dos pa√≠ses destacados
PASSENGERS_CARRIED <- PASSENGERS_CARRIED %>%
  mutate(grupo = case_when(
    iso2c == "BR" ~ "Brasil",
    iso2c == "US" ~ "Estados Unidos",
    TRUE ~ "Outros"
  ))

# Paleta de cores personalizada
cores <- c("Brasil" = "#006400", "Estados Unidos" = "blue", "Outros" = "grey80")

# Gr√°fico
grafpainel <- ggplot(PASSENGERS_CARRIED, aes(x = year, y = IS.AIR.PSGR, group = iso2c)) +
  
  # Linhas para outros pa√≠ses (cinza claro e finas)
  geom_line(data = subset(PASSENGERS_CARRIED, grupo == "Outros"),
            color = "grey80", alpha = 0.4, size = 0.5) +
  
  # Linhas destacadas (Brasil e EUA)
  geom_line(data = subset(PASSENGERS_CARRIED, grupo != "Outros"),
            aes(color = grupo),
            size = 1.5) +
  
  # Pontos destacados
  geom_point(data = subset(PASSENGERS_CARRIED, grupo != "Outros"),
             aes(color = grupo),
             size = 3) +
  
  # T√≠tulos e legenda
  labs(
    title = "Passageiros Transportados por Via A√©rea",
    x = "Ano",
    y = "Passageiros Transportados (milh√µes)",
    color = "Pa√≠s"
  ) +
  
  scale_color_manual(values = cores) +
  
  theme_minimal(base_size = 14) +
  theme(
    plot.title = element_text(face = "bold", size = 16, hjust = 0.5),
    legend.position = "bottom"
  )
# Exibir o gr√°fico
print(grafpainel)
```

## GR√ÅFICO CORTE TRANSVERSAL

Um gr√°fico de dados de corte transversal √© usado para apresentar informa√ß√µes de v√°rios elementos (como pa√≠ses, estados ou regi√µes) em um √∫nico momento no tempo.

Esse tipo de gr√°fico permite comparar como diferentes unidades se posicionam em rela√ß√£o a uma vari√°vel em um determinado per√≠odo, ajudando a identificar desigualdades ou padr√µes de comportamento. Por exemplo, ao analisar este gr√°fico podemos identificar das for√ßas armadas de v√°rios pa√≠ses por√©m destacando em azul as informa√ß√µes dos Estados Unidos.

```{r}
#| label: cortetransversal
#| warning: false
#| echo: false  

# Corrigir: n√£o instalar nem carregar gganimate
# (n√£o precisa de install.packages nem library(gganimate))

library(gghighlight) # pacote para destaque

# Criar vari√°vel de destaque

#lista dos codigos iso3c para filtragem dos paises
lista_iso3c <- codelist %>%
  select(iso3c)

# seleciona apenas os paises e classifica os 10 maiores
# cria a coluna pais_destacado
FORCAS_ARMADAS <- FORCAS_ARMADAS %>%
  mutate(pais_destacado = ifelse(country == "United States", "Estados Unidos", "Outros")) %>%
  inner_join(lista_iso3c, by = join_by(iso3c)) %>%
  top_n(10, MS.MIL.TOTL.P1) %>%
  arrange(desc(MS.MIL.TOTL.P1))

# Gr√°fico
ggplot(FORCAS_ARMADAS, aes(x = MS.MIL.TOTL.P1, y = country)) +
  
  # Outros pa√≠ses
  geom_col() +
  
  # Estados Unidos
  # geom_point(data = filter(FORCAS_ARMADAS, pais_destacado == "Estados Unidos"),
  #           color = "blue",
  #          size = 5) +
  
  labs(
    title = "Efetivo das For√ßas Armadas em 2020",
    subtitle = "Destaque para os Estados Unidos",
    x = "Ano",
    y = "For√ßas Armadas (Total de Pessoal)",
    color = "Pa√≠s"
  ) +
  scale_color_manual(values = c("Outros" = "gray70", "Estados Unidos" = "blue")) +
  theme_minimal(base_size = 14) +
  theme(
    plot.title = element_text(face = "bold", size = 16, hjust = 0.5),
    plot.subtitle = element_text(size = 12, hjust = 0.5),
    legend.position = "bottom"
  ) +
  gghighlight(country == "United States")
```

## GR√ÅFICO S√âRIE TEMPORAL

O gr√°fico de dados de s√©rie temporal √© utilizado para acompanhar o desenvolvimento de uma √∫nica vari√°vel ao longo dos anos. Esse tipo de gr√°fico permite observar como uma vari√°vel se altera ao longo de diferentes per√≠odos, ajudando a identificar tend√™ncias, ciclos e varia√ß√µes sazonais.

Com a s√©rie temporal, √© poss√≠vel ver a evolu√ß√£o da Produ√ß√£o de Cereal da China de maneira progressiva, identificando, por exemplo, anos de acelera√ß√£o ou estagna√ß√£o.

```{r}
#| label: serietemporal
#| warning: false 
#| echo: false    

ggplot(producao_cereal, aes(x = year, y = AG.PRD.CREL.MT)) +
  
  # Linha da China em vermelho vibrante
  geom_line(color = "#FF4500", size = 2) +
  
  # Pontos em gradiente para destacar valores
  geom_point(aes(color = AG.PRD.CREL.MT), size = 3) +
  
  # Escala de cor vibrante (azul para vermelho intenso)
  scale_color_gradient(low = "#00FFFF", high = "#FF4500") +
  
  # T√≠tulos e eixos personalizados
  labs(
    title = "üöÄ Produ√ß√£o de Cereal na China (S√©rie Temporal)",
    subtitle = "Evolu√ß√£o ao longo dos anos com destaque moderno",
    x = "Ano",
    y = "Produ√ß√£o de Cereal (Toneladas)",
    color = "Produ√ß√£o"
  ) +
  
  # Tema moderno com fundo escuro
  theme_minimal(base_size = 14) +
  theme(
    plot.background = element_rect(fill = "#121212", color = NA),
    panel.background = element_rect(fill = "#121212", color = NA),
    panel.grid.major = element_line(color = "#444444"),
    panel.grid.minor = element_line(color = "#444444"),
    plot.title = element_text(face = "bold", size = 18, hjust = 0.5, color = "white"),
    plot.subtitle = element_text(size = 12, hjust = 0.5, color = "white"),
    axis.title = element_text(color = "white"),
    axis.text = element_text(color = "white"),
    legend.title = element_text(color = "white"),
    legend.text = element_text(color = "white")
  )


```
